# ping360_sonar
[![GitHub stars](https://img.shields.io/github/stars/CentraleNantesRobotics/ping360_sonar_python.svg?style=social&label=Star&maxAge=2592000)](https://GitHub.com/CentraleNantesRobotics/ping360_sonar_python/stargazers/)
[![GitHub forks](https://img.shields.io/github/forks/CentraleNantesRobotics/ping360_sonar_python.svg?style=social&label=Fork&maxAge=2592000)](https://GitHub.com/CentraleNantesRobotics/ping360_sonar_python/network/)
[![GitHub issues](https://img.shields.io/github/issues/CentraleNantesRobotics/ping360_sonar_python.svg)](https://GitHub.com/CentraleNantesRobotics/ping360_sonar_python/issues/)
[![GitHub license](https://img.shields.io/github/license/CentraleNantesRobotics/ping360_sonar_python.svg)](https://github.com/CentraleNantesRobotics/ping360_sonar_python/blob/master/LICENSE)
[![Github all releases](https://img.shields.io/github/downloads/CentraleNantesRobotics/ping360_sonar_python/total.svg)](https://GitHub.com/CentraleNantesRobotics/ping360_sonar_python/releases/)
[![GitHub release](https://img.shields.io/github/release/CentraleNantesRobotics/ping360_sonar_python.svg)](https://GitHub.com/CentraleNantesRobotics/ping360_sonar_python/releases/)
[![All Contributors](https://img.shields.io/badge/all_contributors-1-orange.svg?style=flat-square)](#contributors-)
## Overview

A python ROS package for the [BlueRobotics] [Ping360] Sonar. The package has been tested under [ROS] melodic and Ubuntu 16.04. This code is mostly experimental, expect that it changes often.

**Keywords:** ROS, package, ping360, ping360 emulator

### License

The source code is released under a [MIT license](LICENSE).

## Installation

### Download the latest release

Get the latest stable release [here](https://github.com/CentraleNantesRobotics/ping360_sonar_python/releases/latest).

### Building from Source

#### Dependencies

- [Robot Operating System (ROS)](http://wiki.ros.org) (middleware for robotics),
- opencv
- [cv_bridge]

#### Building

Before building from source, install [ping-protocol Python Lib](https://pypi.org/project/bluerobotics-ping/):

	pip install bluerobotics-ping

To build from source, clone the latest version from this repository into your catkin workspace and compile the package using

	cd catkin_workspace/src
	git clone https://github.com/CentraleNantesRobotics/ping360_sonar_python.git
	cd ../
	catkin build

### Unit Tests

TODO

## Usage

An example launch file has been provided [example.launch](launch/example.launch):

Run the main node with:

	roslaunch ping360_sonar example.launch

## Launch files

* **example.launch:** contains the default parameteres to run the Ping360 Sonar, including the serial port and the baudrate to interface with the sonar. The rest of the parameters are documented here: [Ping360 Documentation](https://docs.bluerobotics.com/ping-protocol/pingmessage-ping360/). The same parameters can also be reconfigured using the [dynamic_reconfigure](http://wiki.ros.org/dynamic_reconfigure).

	An emulated mode was added to test the package when you don't have the sonar. To run the emulated sonar, set the env variable to "true":

		<env name="emulated_sonar" value="true" />

## Nodes

### ping360_node

While continuously rotating the sonar, it publishes two types of messages:
- The sonar's response data (the echo intensities for a given angle & range)
- A black and white image using the date received from the sonar. Same as the one generated by the ping viewer.


#### Published Topics

* **`/ping360_node/sonar/images`** ([sensor_msgs/Image])

	The generated sonar image. 

* **`/ping360_node/sonar/data`** ([msg/SonarEcho])

	Publishes the raw sonar data in a custom message:
	
		Header header            #header info
		float32 angle               # the measurement angle [rad]
		uint8 gain  # Sonar Gain
		uint16 number_of_samples 
		uint16 transmit_frequency # [kHz]
		uint16 speed_of_sound # [m/s]
		uint8 range      #  range value [m]
		uint8[] intensities    # intensity data [0-255].  This is the actual data received from the sonar


## Bugs & Feature Requests

Please report bugs and request features using the [Issue Tracker](https://github.com/CentraleNantesRobotics/ping360_sonar_python/issues).


[ROS]: http://www.ros.org
[BlueRobotics]: http://bluerobotics.com
[cv_bridge]: http://wiki.ros.org/cv_bridge
[sensor_msgs/Image]: http://docs.ros.org/melodic/api/sensor_msgs/html/msg/Image.html
[Ping360]: https://bluerobotics.com/store/sensors-sonars-cameras/sonar/ping360-sonar-r1-rp/
[msg/SonarEcho]: /msg/SonarEcho.msg

## Contributors ‚ú®

<!-- ALL-CONTRIBUTORS-LIST:START - Do not remove or modify this section -->
<!-- prettier-ignore-start -->
<!-- markdownlint-disable -->
<table>
  <tr>
    <td align="center"><a href="https://github.com/Hameck"><img src="https://avatars2.githubusercontent.com/u/14954732?v=4" width="100px;" alt=""/><br /><sub><b>Henrique Martinez Rocamora</b></sub></a><br /><a href="https://github.com/CentraleNantesRobotics/ping360_sonar_python/commits?author=Hameck" title="Code">üíª</a> <a href="https://github.com/CentraleNantesRobotics/ping360_sonar_python/commits?author=Hameck" title="Tests">‚ö†Ô∏è</a></td>
  </tr>
</table>

<!-- markdownlint-enable -->
<!-- prettier-ignore-end -->
<!-- ALL-CONTRIBUTORS-LIST:END -->

This project follows the [all-contributors](https://github.com/all-contributors/all-contributors) specification. 
Contributions of any kind welcome! Please refer to our [Contribution Guide](CONTRIBUTING.md)

